<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/QAPage">
<head>

<title>multithreading - Multithreaded image processing in C++ - Stack Overflow</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/stackoverflow/img/favicon.ico?v=4f32ecc8f43d">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png?v=c78bd457575a">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content="stackoverflow.com"/>
    <meta property="og:type" content="website" />    
    <meta property="og:image" itemprop="image primaryImageOfPage" content="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon@2.png?v=73d79a89bded&a" />
    <meta name="twitter:title" property="og:title" itemprop="title name" content="Multithreaded image processing in C++" />
    <meta name="twitter:description" property="og:description" itemprop="description" content="I am working on a program which manipulates images of different sizes.  Many of these manipulations read pixel data from an input and write to a separate output (e.g. blur).  This is done on a per-..." />
    <meta property="og:url" content="http://stackoverflow.com/questions/326487/multithreaded-image-processing-in-c/2072896"/>
    <link rel="canonical" href="http://stackoverflow.com/questions/326487/multithreaded-image-processing-in-c/2072896" />

    
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=2ad47c1cbf74"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/stackoverflow/all.css?v=ff9c04b6645a">

            <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Multithreaded image processing in C++&#39;" href="/feeds/question/326487">
            <meta name="twitter:app:country" content="US" />
            <meta name="twitter:app:name:iphone" content="Stack Exchange iOS" />
            <meta name="twitter:app:id:iphone" content="871299723" />
            <meta name="twitter:app:url:iphone" content="se-zaphod://stackoverflow.com/questions/326487/multithreaded-image-processing-in-c/2072896" />
            <meta name="twitter:app:name:ipad" content="Stack Exchange iOS" />
            <meta name="twitter:app:id:ipad" content="871299723" />
            <meta name="twitter:app:url:ipad" content="se-zaphod://stackoverflow.com/questions/326487/multithreaded-image-processing-in-c/2072896" />
            <meta name="twitter:app:name:googleplay" content="Stack Exchange Android">
            <meta name="twitter:app:url:googleplay" content="http://stackoverflow.com/questions/326487/multithreaded-image-processing-in-c/2072896">
            <meta name="twitter:app:id:googleplay" content="com.stackexchange.marvin">
        <script>
        
            StackExchange.ready(function () {
                    
                    StackExchange.using("snippets", function () {
                        StackExchange.snippets.initSnippetRenderer();
                    });
                    

                StackExchange.using("postValidation", function () {
                    StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
                });

                
                StackExchange.question.init({showAnswerHelp:true,totalCommentCount:3,shownCommentCount:3,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:326487});

                styleCode();

                    StackExchange.realtime.subscribeToQuestion('1', '326487');
                                                                    StackExchange.using("gps", function () { StackExchange.gps.trackOutboundClicks('#content', '.post-text'); });

            });
        </script>


    <script>
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1452569299,"networkMetaHostname":"meta.stackexchange.com","routeName":"Questions/Show","styleCode":true,"enableUserHovercards":true,"snippets":{"enabled":true,"domain":"stacksnippets.net"},"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","recaptchaAudioLang":"en","enableNewTagCreationWarning":true,"insertSpaceAfterNameTabCompletion":false,"id":1,"enableSocialMediaInSharePopup":true},"user":{"fkey":"8872ec4c653acc968af5bcb434502271","rep":0,"isAnonymous":true,"isAnonymousNetworkWide":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"89e086192993","js/moderator.en.js":"7b2687f4cf30","js/full-anon.en.js":"b07e91421e2e","js/full.en.js":"a5e983bd7490","js/wmd.en.js":"bdc36644892f","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"f58acd4f09d3","js/help.en.js":"8ccb22b4d37a","js/tageditor.en.js":"a24a0049a77a","js/tageditornew.en.js":"53847fa72831","js/inline-tag-editing.en.js":"314cfb72355b","js/revisions.en.js":"df3cb25dfabf","js/review.en.js":"abdba91a2e50","js/tagsuggestions.en.js":"d1ff9b84abe5","js/post-validation.en.js":"5faa9f5da067","js/explore-qlist.en.js":"e71f14781288","js/events.en.js":"3874cd280138","js/keyboard-shortcuts.en.js":"2ee500392c30","js/external-editor.en.js":"cf58cc6630ef","js/external-editor.en.js":"cf58cc6630ef","js/snippet-javascript.en.js":"f590e314ee2d","js/snippet-javascript-codemirror.en.js":"20797e12ebbb"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
    </script>
    
        <script>
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
    
    
</head>
<body class="question-page new-topbar">
    <noscript><div id="noscript-padding"></div></noscript>
    




    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>





<div class="topbar">
    <div class="topbar-wrapper">

        <div class="js-topbar-dialog-corral">


<div class="topbar-dialog siteSwitcher-dialog dno">
    <div class="header">
        <h3><a href="//stackoverflow.com">current community</a></h3>
    </div>
    <div class="modal-content current-site-container">
        <ul class="current-site">
                <li>
                        <div class="related-links">
                    <a href="http://chat.stackoverflow.com" class="js-gps-track"     data-gps-track="site_switcher.click({ item_type:6 })"
>chat</a>
            </div>




    <a href="//stackoverflow.com"
       class="current-site-link site-link js-gps-track"
       data-id="1"
       data-gps-track="
        site_switcher.click({ item_type:3 })">
        <div class="site-icon favicon favicon-stackoverflow" title="Stack Overflow"></div>
        Stack Overflow
    </a>

                </li>
                <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    



    <a href="http://meta.stackoverflow.com"
       class="site-link js-gps-track"
       data-id="552"
       data-gps-track="
            site.switch({ target_site:552, item_type:3 }),
        site_switcher.click({ item_type:4 })">
        <div class="site-icon favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>
        Meta Stack Overflow
    </a>

                </li>
                            <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    <a class="site-link js-gps-track"
                       href="//careers.stackoverflow.com?utm_source=stackoverflow.com&amp;utm_medium=site-ui&amp;utm_campaign=multicollider"
                            data-gps-track="site_switcher.click({ item_type:9 })"
>
                        <div class="site-icon favicon favicon-careers" title="Stack Overflow Careers"></div>
                        Stack Overflow Careers
                    </a>
                </li>
        </ul>
    </div>
    
    <div class="header" id="your-communities-header">
        <h3>
your communities        </h3>
            
    </div>
    <div class="modal-content" id="your-communities-section">
            
            <div class="call-to-login">
<a href="https://stackoverflow.com/users/signup?ssrc=site_switcher&amp;returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%2f2072896" class="login-link js-gps-track"     data-gps-track="site_switcher.click({ item_type:10 })"
>Sign up</a> or <a href="https://stackoverflow.com/users/login?ssrc=site_switcher&amp;returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%2f2072896" class="login-link js-gps-track"     data-gps-track="site_switcher.click({ item_type:11 })"
>log in</a> to customize your list.
            </div>
    </div>
    
    <div class="header">
        <h3><a href="//stackexchange.com/sites">more stack exchange communities</a></h3>
        <a href="http://blog.stackoverflow.com" class="fr">company blog</a>
    </div>
    <div class="modal-content">
            <div class="child-content"></div>
    </div>
</div>
        </div>

        <div class="network-items">

            <a href="//stackexchange.com"
               class="topbar-icon icon-site-switcher yes-hover js-site-switcher-button js-gps-track"
               data-gps-track="site_switcher.show"
               title="A list of all 151 Stack Exchange sites">
                <span class="hidden-text">Stack Exchange</span>
            </a>

    <a href="#"
       class="topbar-icon icon-inbox yes-hover js-inbox-button"
       title="Recent inbox messages">
        <span class="hidden-text">Inbox</span>
        <span class="unread-count" style="display:none"></span>
    </a>
    <a href="#"
       class="topbar-icon icon-achievements yes-hover js-achievements-button "
       data-unread-class=""
       title="Recent achievements: reputation, badges, and privileges earned">
        <span class="hidden-text">Reputation and Badges</span>
        <span class="unread-count" style="display:none">
            
        </span>
    </a>
        </div>

        <div class="topbar-links">

                <div class="links-container">
                <span class="topbar-menu-links">
                                    <a href="https://stackoverflow.com/users/signup?ssrc=head&returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%2f2072896" class="login-link">sign up</a>
                                <a href="https://stackoverflow.com/users/login?ssrc=head&returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%2f2072896" class="login-link">log in</a>

                        <a href="/tour">tour</a>
                            <a href="#" class="icon-help js-help-button" title="Help Center and other resources">
        help
        <span class="triangle"></span>
    </a>
    <div class="topbar-dialog help-dialog js-help-dialog dno">
        <div class="modal-content">
            <ul>
                                    <li>
                        <a href="/tour" class="js-gps-track" data-gps-track="help_popup.click({ item_type:1 })">
                            Tour
                            <span class="item-summary">
                                Start here for a quick overview of the site
                            </span>
                        </a>
                    </li>
                <li>
                    <a href="/help" class="js-gps-track" data-gps-track="help_popup.click({ item_type:4 })">
                        Help Center
                        <span class="item-summary">
                            Detailed answers to any questions you might have
                        </span>
                    </a>
                </li>
                    <li>
                        <a href="//meta.stackoverflow.com" class="js-gps-track" data-gps-track="help_popup.click({ item_type:2 })">
                            Meta
                            <span class="item-summary">
                                Discuss the workings and policies of this site
                            </span>
                        </a>
                    </li>
            </ul>
        </div>
    </div>

                    </span>
                </div>

            <div class="search-container">
                <form id="search" action="/search" method="get" autocomplete="off">
                    <input name="q" type="text" placeholder="search" value="" tabindex="1" autocomplete="off" maxlength="240" />
                </form>
            </div>

        </div>
    </div>
</div>
    <script>
        StackExchange.ready(function() { StackExchange.topbar.init(); });
    </script>

    <div class="container">
        <div id="header">
            <br class="cbt">
            <div id="hlogo">
                <a href="/" >
                    Stack Overflow
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs">
                    <ul>
                        <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-jobs" href="/jobs">Jobs<span class="nav-jobs-beta">beta</span></a></li>
                        <li><a id="nav-tags" href="/tags">Tags</a></li>
                        <li><a id="nav-users" href="/users">Users</a></li>
                        <li><a id="nav-badges" href="/help/badges">Badges</a></li>
                                            </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content" class="snippet-hidden">
            

<div itemscope itemtype="http://schema.org/Question">
    <link itemprop="image" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png?v=c78bd457575a">

<div id="herobox">
    <div id="hero-content">
            <div id="close"><a title="click to minimize">_</a></div>
        <div id="blurb">
            Stack Overflow is a community of 4.7 million programmers, just like you, helping each other.
            <br/>
                <br/>Join them; it only takes a minute:<br/>
            <br/>
            <a href="/users/signup?ssrc=hero&amp;returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%2f2072896" id="tell-me-more" class="button">Sign up</a>
        </div>
        <div id="desc">
            <b>Join the Stack Overflow community to:</b>
            <ol id="hiw">
                <li id="q">Ask programming questions
                </li>
                <li id="an">Answer and help your peers
                </li>
                <li id="b">Get recognized for your expertise
                </li>
            </ol>
        </div>
        <div style="clear: both"></div>
    </div>
    <script>
        StackExchange.ready(function () {

            var location = 0;
            if ($("body").hasClass("questions-page")) {
                location = 1;;
            } else if ($("body").hasClass("question-page")) {
                location = 1;;
            } else if ($("body").hasClass("faq-page")) {
                location = 5;;
            } else if ($("body").hasClass("home-page")) {
                location = 3;;
            }

            $('#tell-me-more').click(function () {
                StackExchange.using("gps", function () {
                    StackExchange.gps.track("hero.action", { hero_action_type: 'cta', location: location }, true);
                });
            });
            $('#herobox #close').click(function () {
                StackExchange.using("gps", function () {
                    StackExchange.gps.track("hero.action", { hero_action_type: "minimize", location: location }, true);
                });
                $.cookie("hero", "mini", { path: "/", expires: 365 });
                $.ajax({
                    url: "/hero-mini",
                    success: function (data) {
                        $("#herobox").fadeOut("fast", function () {
                            $("#herobox").replaceWith(data);
                            $("#herobox-mini").fadeIn("fast");
                        });
                    }
                });
                return false;
            });
        });

    </script>
</div>
			<div id="question-header">
                <h1 itemprop="name"><a href="/questions/326487/multithreaded-image-processing-in-c" class="question-hyperlink">Multithreaded image processing in C++</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="326487"  id="question">

    <script>
                var ados = ados || {}; ados.run = ados.run || [];
                ados.run.push(function () { ados_add_placement(22,8277,"adzerk391031875",4).setZone(43); });
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk391031875">
            </div>    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326487">
        <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">11</span>
        <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>

        <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
        <div class="favoritecount"><b>4</b></div>


</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="text">

<p>I am working on a program which manipulates images of different sizes.  Many of these manipulations read pixel data from an input and write to a separate output (e.g. blur).  This is done on a per-pixel basis.</p>

<p>Such image mapulations are very stressful on the CPU.  I would like to use multithreading to speed things up.  How would I do this?  I was thinking of creating one thread per row of pixels.</p>

<p>I have several requirements:</p>

<ul>
<li>Executable size must be minimized.  In other words, I can't use massive libraries.  What's the most light-weight, portable threading library for C/C++?</li>
<li>Executable size must be minimized.  I was thinking of having a function forEachRow(fp* ) which runs a thread for each row, or even a forEachPixel(fp* ) where fp operates on a single pixel in its own thread.  Which is best?
<ul>
<li>Should I use normal functions or functors or functionoids or some lambda functions or ... something else?</li>
<li>Some operations use optimizations which require information from the previous pixel processed.  This makes forEachRow favorable.  Would using forEachPixel be better even considering this?</li>
</ul></li>
<li>Would I need to lock my read-only and write-only arrays?
<ul>
<li>The input is only read from, but many operations require input from more than one pixel in the array.</li>
<li>The ouput is only written once per pixel.</li>
</ul></li>
<li>Speed is also important (of course), but optimize executable size takes precedence.</li>
</ul>

<p>Thanks.</p>

<p><strong>More information on this topic for the curious: <a href="http://stackoverflow.com/questions/615264/c-parallelization-libraries-openmp-vs-thread-building-blocks">C++ Parallelization Libraries: OpenMP vs. Thread Building Blocks</a></strong></p>
    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <a href="/questions/tagged/multithreading" class="post-tag" title="show questions tagged &#39;multithreading&#39;" rel="tag">multithreading</a> <a href="/questions/tagged/optimization" class="post-tag" title="show questions tagged &#39;optimization&#39;" rel="tag">optimization</a> <a href="/questions/tagged/image-processing" class="post-tag" title="show questions tagged &#39;image-processing&#39;" rel="tag">image-processing</a> <a href="/questions/tagged/parallel-processing" class="post-tag" title="show questions tagged &#39;parallel-processing&#39;" rel="tag">parallel-processing</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/q/326487" title="short permalink to this question" class="short-link" id="link-post-326487">share</a><span class="lsep">|</span><a href="/posts/326487/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/326487/revisions" title="show all edits to this post">edited <span title="2009-03-07 01:13:33Z" class="relativetime">Mar 7 '09 at 1:13</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
    <td class="post-signature owner">
        <div class="user-info ">
    <div class="user-action-time">
        asked <span title="2008-11-28 19:24:49Z" class="relativetime">Nov 28 '08 at 19:24</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/39992/strager"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/8f3486a6fd9309188a9560d432bf046d?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/39992/strager">strager</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 52793" dir="ltr">52.8k</span><span title="11 gold badges"><span class="badge1"></span><span class="badgecount">11</span></span><span title="89 silver badges"><span class="badge2"></span><span class="badgecount">89</span></span><span title="144 bronze badges"><span class="badge3"></span><span class="badgecount">144</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
                
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326487" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165807" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You mention below that &quot;Each image manipulation takes anywhere from 8 seconds to 6 minutes of my 1.7GHz 64-bit system&quot;.  How big are your images?  Is this just for blur?  It almost sounds like you may be using a slow algorithm, unless your images are very large.</span>
                    &ndash;&nbsp;<a href="/users/9122/tgamblin"
                       title="32635 reputation"
                       class="comment-user">tgamblin</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:10:22Z" class="relativetime-clean">Nov 28 '08 at 22:10</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165828" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">My images are in orders of 256x256 to 4096x4096.  The 6 minute operation is a combination of several filters, but the slowest one in the pack takes about five minutes alone.  They are more complex operations, such as (real) perlin noise, bumpmapping, and nearest-distance/cellular.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:24:05Z" class="relativetime-clean">Nov 28 '08 at 22:24</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165839" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Ah ok -- given all that, I&#39;d say that OpenMP is the easiest way to parallelize this, and would require the least amount of changes to your code (restructure some loops, add pragmas).  If you can&#39;t do OpenMP, use a work queue.  You&#39;ll just have to do all the partitioning and synchronization yourself.</span>
                    &ndash;&nbsp;<a href="/users/9122/tgamblin"
                       title="32635 reputation"
                       class="comment-user">tgamblin</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:34:15Z" class="relativetime-clean">Nov 28 '08 at 22:34</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326487" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>        </table>
</div>

			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								16 Answers
                                <span style="display:none;" itemprop="answerCount">16</span>
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/326487/multithreaded-image-processing-in-c?answertab=active#tab-top" data-nav-xhref="" title="Answers with the latest activity first" data-value="active">
            active</a>
        <a href="/questions/326487/multithreaded-image-processing-in-c?answertab=oldest#tab-top" data-nav-xhref="" title="Answers in the order they were provided" data-value="oldest">
            oldest</a>
        <a class="youarehere" href="/questions/326487/multithreaded-image-processing-in-c?answertab=votes#tab-top" data-nav-xhref="" title="Answers with the highest score first" data-value="votes">
            votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="326524"></a>
<div id="answer-326524" class="answer accepted-answer" data-answerid="326524"  itemscope itemtype="http://schema.org/Answer" itemprop="acceptedAnswer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326524">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">10</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>



        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>

</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>If your compiler supports <a href="http://openmp.org/wp/" rel="nofollow">OpenMP</a> (I know <a href="http://msdn.microsoft.com/en-us/library/tt15eb9t(VS.80).aspx" rel="nofollow">VC++ 8.0 and 9.0</a> do, as does gcc), it can make things like this much easier to do.  </p>

<p>You don't just want to make a lot of threads - there's a point of diminishing returns where adding new threads slows things down as you start getting more and more context switches. At some point, using too many threads can actually make the parallel version slower than just using a linear algorithm. The optimal number of threads is a function of the number of cpus/cores available, and the percentage of time each thread spends blocked on things like I/O.  Take a look at <a href="http://www.ddj.com/cpp/211800538" rel="nofollow">this article</a> by Herb Sutter for some discussion on parallel performance gains.  </p>

<p>OpenMP lets you easily adapt the number of threads created to the number of CPUs available.  Using it (especially in data-processing cases) often involves simply putting in a few <code>#pragma omp</code>s in existing code, and letting the compiler handle creating threads and synchronization.</p>

<p>In general - as long as data isn't changing, you won't have to lock read-only data.  If you can be sure that each pixel slot will only be written once and you can guarantee that all the writing has been completed before you start reading from the result, you won't have to lock that either.  </p>

<p>For OpenMP, there's no need to do anything special as far as functors / function objects.  Write it whichever way makes the most sense to you.  Here's an image-processing example from <a href="http://software.intel.com/en-us/articles/getting-started-with-openmp" rel="nofollow">Intel</a> (converts rgb to grayscale):</p>

<pre><code>#pragma omp parallel for
for (i=0; i &lt; numPixels; i++)
{
   pGrayScaleBitmap[i] = (unsigned BYTE)
       (pRGBBitmap[i].red * 0.299 +
        pRGBBitmap[i].green * 0.587 +
        pRGBBitmap[i].blue * 0.114);
}
</code></pre>

<p>This automatically splits up into as many threads as you have CPUs, and assigns a section of the array to each thread.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326524" title="short permalink to this answer" class="short-link" id="link-post-326524">share</a><span class="lsep">|</span><a href="/posts/326524/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/326524/revisions" title="show all edits to this post">edited <span title="2008-11-28 21:25:56Z" class="relativetime">Nov 28 '08 at 21:25</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:50:31Z" class="relativetime">Nov 28 '08 at 19:50</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/8701/eclipse"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/369fe4f874d2b26fd2441a0e5017f894?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/8701/eclipse">Eclipse</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 31314" dir="ltr">31.3k</span><span title="9 gold badges"><span class="badge1"></span><span class="badgecount">9</span></span><span title="86 silver badges"><span class="badge2"></span><span class="badgecount">86</span></span><span title="148 bronze badges"><span class="badge3"></span><span class="badgecount">148</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326524" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="2"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165760" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I like the concept of OpenMP.  Sadly, I don&#39;t have a compiler which supports it.  I&#39;ll have to ask my project manager if using compiler-specific options is okay.  OpenMP code runs unthreaded on non-OpenMP compilers, correct?</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 21:30:08Z" class="relativetime-clean">Nov 28 '08 at 21:30</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165798" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Yes.  It should.</span>
                    &ndash;&nbsp;<a href="/users/9122/tgamblin"
                       title="32635 reputation"
                       class="comment-user">tgamblin</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:02:44Z" class="relativetime-clean">Nov 28 '08 at 22:02</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165973" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Just tested on gcc-4.3.2; works like a charm.  Many thanks!  (Hopefully it&#39;ll work well for Windows and Mac OS X as well...)</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 01:30:07Z" class="relativetime-clean">Nov 29 '08 at 1:30</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-166094" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You&#39;re wrong about the writing case.  See my post below under &quot;fencepost&quot; issues where one thread writes part of a memory word, and another thread writes the other part.  Different bytes for each thread, but part of the same memory word.</span>
                    &ndash;&nbsp;<a href="/users/37946/mr-ree"
                       title="5944 reputation"
                       class="comment-user">Mr.Ree</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 04:10:26Z" class="relativetime-clean">Nov 29 '08 at 4:10</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-166142" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@mrree.myopenid.com, My data is all word-aligned (and not &quot;packed&quot;) so this shouldn&#39;t be an issue, right?</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 05:07:12Z" class="relativetime-clean">Nov 29 '08 at 5:07</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326524" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link  dno"
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   ></a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link " title="expand to show all comments on this post" href=# onclick="">show <b>2</b> more comments</a>
        </div>         
    </td>
</tr>    </table>
</div>
<script>
                var ados = ados || {}; ados.run = ados.run || [];
                ados.run.push(function () { ados_add_placement(22,8277,"adzerk695596474",4).setZone(44); });
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk695596474">
            </div>
  
<a name="327143"></a>
<div id="answer-327143" class="answer" data-answerid="327143"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="327143">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">12</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p><strong>Don't embark on threading lightly!</strong>  The race conditions can be a major pain in the arse to figure out.  Especially if you don't have a lot of experience with threads!  <strong>(You've been warned:  Here be dragons!  Big hairy non-deterministic impossible-to-reliably-reproduce dragons!)</strong></p>

<p><a href="http://en.wikipedia.org/wiki/Deadlock">Do you know what deadlock is?  How about Livelock?</a></p>

<p>That said...</p>

<p><hr /></p>

<p>As ckarmann and others have already suggested:  <strong>Use a work-queue model.  One thread per CPU core.</strong>  Break the work up into N chunks.  Make the chunks reasonably large, like many rows.  As each thread becomes free, it snags the next work chunk off the queue.</p>

<p>In the simplest <em>IDEAL</em> version, you have N cores, N threads, and N subparts of the problem with each thread knowing from the start exactly what it's going to do.</p>

<p>But that doesn't usually happen in practice due to the overhead of starting/stopping threads.  You really want the threads to already be spawned and waiting for action.  (E.g. Through a semaphore.)</p>

<p>The work-queue model itself is quite powerful.  It lets you parallelize things like quick-sort, which normally doesn't parallelize across N threads/cores gracefully.</p>

<p><hr /></p>

<p>More threads than cores?  You're just wasting overhead.  Each thread has overhead.  Even at #threads=#cores, you will never achieve a perfect Nx speedup factor.</p>

<p>One thread per row would be very inefficient!  One thread per pixel?  I don't even want to think about it.  (That per-pixel approach makes a lot more sense when playing with vectorized processor units like they had on the old Crays.  But not with threads!)</p>

<p><hr /></p>

<p>Libraries?  What's your platform?  Under Unix/Linux/g++ I'd suggest pthreads &amp; semaphores.  (Pthreads is also available under windows with a microsoft compatibility layer.  But, uhgg.  I don't really trust it!  Cygwin might be a better choice there.)</p>

<p>Under Unix/Linux, <em>man</em>:</p>

<pre><code>* pthread_create, pthread_detach.
* pthread_mutexattr_init, pthread_mutexattr_settype, pthread_mutex_init,
* pthread_mutexattr_destroy, pthread_mutex_destroy, pthread_mutex_lock,
* pthread_mutex_trylock, pthread_mutex_unlock, pthread_mutex_timedlock.
* sem_init, sem_destroy, sem_post, sem_wait, sem_trywait, sem_timedwait.
</code></pre>

<p>Some folks like pthreads' condition variables.  But I always preferred POSIX 1003.1b semaphores.  They handle the situation where you want to signal another thread <em>BEFORE</em> it starts waiting somewhat better.  Or where another thread is signaled multiple times.</p>

<p>Oh, and do yourself a favor:  Wrap your thread/mutex/semaphore pthread calls into a couple of C++ classes.  That will simplify matters a lot!</p>

<p><hr /></p>

<p><strong><em>Would I need to lock my read-only and write-only arrays?</em></strong></p>

<p>It depends on your precise hardware &amp; software.  Usually read-only arrays can be freely shared between threads.  But there are cases where that is not so.</p>

<p>Writing is much the same.  Usually, as long as only one thread is writing to each particular memory spot, you are ok.  But there are cases where that is not so!</p>

<p>Writing is more troublesome than reading as you can get into these weird fencepost situations.  Memory is often written as words not bytes.  When one thread writes part of the word, and another writes a different part, depending on the exact timing of which thread does what when (e.g. nondeterministic), you can get some very unpredictable results!</p>

<p><strong>I'd play it safe:  Give each thread its own copy of the read and write areas.  After they are done, copy the data back.  All under mutex, of course.</strong></p>

<p>Unless you are talking about gigabytes of data, memory blits are very fast.  That couple of microseconds of performance time just isn't worth the debugging nightmare.</p>

<p>If you were to share one common data area between threads using mutexes, the collision/waiting mutex inefficiencies would pile up and devastate your efficiency!</p>

<p><hr /></p>

<p>Look, clean data boundaries are the essence of good multi-threaded code.  When your boundaries aren't clear, that's when you get into trouble.</p>

<p>Similarly, it's essential to keep everything on the boundary mutexed!  And to keep the mutexed areas short!</p>

<p>Try to avoid locking more than one mutex at the same time.  If you do lock more than one mutex, always lock them in the same order!</p>

<p>Where possible use ERROR-CHECKING or RECURSIVE mutexes.  FAST mutexes are just asking for trouble, with very little actual (measured) speed gain.</p>

<p>If you get into a deadlock situation, run it in gdb, hit ctrl-c, visit each thread and backtrace.  You can find the problem quite quickly that way.  (Livelock is much harder!)</p>

<p><hr /></p>

<p>One final suggestion:  Build it single-threaded, then start optimizing.  On a single-core system, you may find yourself gaining more speed from things like foo[i++]=bar ==> *(foo++)=bar than from threading.</p>

<p><hr /></p>

<p><strong><em>Addendum:</em></strong>  What I said about <strong><em>keeping mutexed areas short</em></strong> up above?  Consider two threads:  (Given a global shared mutex object of a Mutex class.)</p>

<pre><code>/*ThreadA:*/ while(1){  mutex.lock();  printf("a\n");  usleep(100000); mutex.unlock(); }
/*ThreadB:*/ while(1){  mutex.lock();  printf("b\n");  usleep(100000); mutex.unlock(); }
</code></pre>

<p>What will happen?</p>

<p>Under my version of Linux, one thread will run continuously and the other will starve.  Very very rarely they will change places when a context swap occurs between mutex.unlock() and mutex.lock().</p>

<p><hr /></p>

<p><strong><em>Addendum:</em></strong>  In your case, this is unlikely to be an issue.  But with other problems one may not know in advance how long a particular work-chunk will take to complete.  Breaking a problem down into 100 parts (instead of 4 parts) and using a work-queue to split it up across 4 cores smooths out such discrepancies.</p>

<p>If one work-chunk takes 5 times longer to complete than another, well, it all evens out in the end.  Though with too many chunks, the overhead of acquiring new work-chunks creates noticeable delays.  It's a problem-specific balancing act.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/327143" title="short permalink to this answer" class="short-link" id="link-post-327143">share</a><span class="lsep">|</span><a href="/posts/327143/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/327143/revisions" title="show all edits to this post">edited <span title="2008-11-29 19:06:36Z" class="relativetime">Nov 29 '08 at 19:06</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-11-29 04:04:26Z" class="relativetime">Nov 29 '08 at 4:04</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/37946/mr-ree"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f5a3697b9c9dad86b34df3fd624a1dad?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/37946/mr-ree">Mr.Ree</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">5,944</span><span title="14 silver badges"><span class="badge2"></span><span class="badgecount">14</span></span><span title="23 bronze badges"><span class="badge3"></span><span class="badgecount">23</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-327143" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-166140" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Thanks for your post; you&#39;ve cleared up a lot of questions I&#39;ve had with threading in general. Yes, we are dealing with &quot;gigabytes of data&quot; (more like 64MB blocks), which are all word aligned.  I&#39;m going with OpenMP for individual image processing, but when the time comes I&#39;ll use &quot;normal&quot; threads.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 05:04:10Z" class="relativetime-clean">Nov 29 '08 at 5:04</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-327143" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326493"></a>
<div id="answer-326493" class="answer" data-answerid="326493"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326493">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">6</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I would recommend <code>boost::thread</code> and <code>boost::gil</code> (generic image libray). Because there are quite much templates involved, I'm not sure whether the code-size will still be acceptable for you. But it's part of boost, so it is probably worth a look.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326493" title="short permalink to this answer" class="short-link" id="link-post-326493">share</a><span class="lsep">|</span><a href="/posts/326493/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:31:08Z" class="relativetime">Nov 28 '08 at 19:31</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/34509/johannes-schaub-litb"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/7FnYg.jpg?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/34509/johannes-schaub-litb">Johannes Schaub - litb</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 311490" dir="ltr">311k</span><span title="64 gold badges"><span class="badge1"></span><span class="badgecount">64</span></span><span title="623 silver badges"><span class="badge2"></span><span class="badgecount">623</span></span><span title="993 bronze badges"><span class="badge3"></span><span class="badgecount">993</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326493" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165624" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I would +1, but I don&#39;t have any votes left.  xD  I&#39;ll look into boost::thread.  boost::gil doesn&#39;t seem to be what I&#39;m looking for.  We already have a stable image framework optimized for code size.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 19:44:10Z" class="relativetime-clean">Nov 28 '08 at 19:44</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326493" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326511"></a>
<div id="answer-326511" class="answer" data-answerid="326511"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326511">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">2</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>As a bit of a left-field idea...</p>

<p>What systems are you running this on? Have you thought of using the GPU in your PCs?</p>

<p>Nvidia have the <a href="http://en.wikipedia.org/wiki/CUDA" rel="nofollow">CUDA</a> APIs for this sort of thing</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326511" title="short permalink to this answer" class="short-link" id="link-post-326511">share</a><span class="lsep">|</span><a href="/posts/326511/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:39:50Z" class="relativetime">Nov 28 '08 at 19:39</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/21755/the-archetypal-paul"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/8d1dc85bd2d8ed3a2074b9728fbdaa55?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/21755/the-archetypal-paul">The Archetypal Paul</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 24364" dir="ltr">24.4k</span><span title="13 gold badges"><span class="badge1"></span><span class="badgecount">13</span></span><span title="68 silver badges"><span class="badge2"></span><span class="badgecount">68</span></span><span title="104 bronze badges"><span class="badge3"></span><span class="badgecount">104</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326511" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165621" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Using GLSL and other shader API&#39;s has been considered, but the project manager doesn&#39;t want that to be used.  The project may be ported to devices without these technologies, and we want to maintain portability.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 19:42:00Z" class="relativetime-clean">Nov 28 '08 at 19:42</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326511" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326498"></a>
<div id="answer-326498" class="answer" data-answerid="326498"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326498">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">1</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I don't think you want to have one thread per row. There can be a lot of rows, and you will spend lot of memory/CPU resources just launching/destroying the threads and for the CPU to switch from one to the other. Moreover, if you have P processors with C core, you probably won't have a lot of gain with more than C*P threads.</p>

<p>I would advise you to use a defined number of client threads, for example N threads, and use the main thread of your application to distribute the rows to each thread, or they can simply get instruction from a "job queue". When a thread has finished with a row, it can check in this queue for another row to do.</p>

<p>As for libraries, you can use boost::thread, which is quite portable and not too heavyweight.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326498" title="short permalink to this answer" class="short-link" id="link-post-326498">share</a><span class="lsep">|</span><a href="/posts/326498/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:33:24Z" class="relativetime">Nov 28 '08 at 19:33</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/39622/cyrille-ka"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/PmSK3.jpg?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/39622/cyrille-ka">Cyrille Ka</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 10183" dir="ltr">10.2k</span><span title="2 gold badges"><span class="badge1"></span><span class="badgecount">2</span></span><span title="23 silver badges"><span class="badge2"></span><span class="badgecount">23</span></span><span title="47 bronze badges"><span class="badge3"></span><span class="badgecount">47</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326498" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165628" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Thanks for your answer.  I never considered a job queue; good idea.  Also, I forgot that there&#39;s a hardware limit as well -- thanks for pointing that out.  boost::thread::hardware_concurrency is what I need, correct?</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 19:45:51Z" class="relativetime-clean">Nov 28 '08 at 19:45</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165797" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I think OpenMP would be an easier way to do this.  It&#39;ll do all the work of spawning threads and divying up loop iterations for you.</span>
                    &ndash;&nbsp;<a href="/users/9122/tgamblin"
                       title="32635 reputation"
                       class="comment-user">tgamblin</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:02:00Z" class="relativetime-clean">Nov 28 '08 at 22:02</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326498" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326507"></a>
<div id="answer-326507" class="answer" data-answerid="326507"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326507">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">1</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Can I ask which platform you're writing this for? I'm guessing that because executable size is an issue you're not targetting on a desktop machine. In which case does the platform have multiple cores or hyperthreaded? If not then adding threads to your application could have the opposite effect and slow it down...</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326507" title="short permalink to this answer" class="short-link" id="link-post-326507">share</a><span class="lsep">|</span><a href="/posts/326507/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:37:35Z" class="relativetime">Nov 28 '08 at 19:37</span>
    </div>
    <div class="user-gravatar32">
        <span class="anonymous-gravatar"></span>
    </div>
    <div class="user-details">
        Interested Bystander
        <div class="-flair">
            
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326507" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165623" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">We are targeting all kinds of platforms, ranging from desktop computers to handheld devices.  Multithreading is important for the desktops, obviously.  Size is an issue for reasons relating to packaging, not hardware.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 19:43:02Z" class="relativetime-clean">Nov 28 '08 at 19:43</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165627" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You might want to consider offering different solutions to different architectures. Multithread programs are faster if you do have the cores, for a handheld (were performance is even more important) it will slow down the processing.</span>
                    &ndash;&nbsp;<a href="/users/36565/david-rodr%c3%adguez-dribeas"
                       title="142000 reputation"
                       class="comment-user">David Rodr&#237;guez - dribeas</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 19:45:28Z" class="relativetime-clean">Nov 28 '08 at 19:45</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165631" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@dribeas, I do realize that multithreading on handhelds doesn&#39;t increase performance (and will probably decrease performance).  That&#39;s what #ifdef is for, right?  =]</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 19:46:54Z" class="relativetime-clean">Nov 28 '08 at 19:46</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326507" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="327566"></a>
<div id="answer-327566" class="answer" data-answerid="327566"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="327566">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">1</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>To optimize simple image transformations, you are far better off using SIMD vector math than trying to multi-thread your program.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/327566" title="short permalink to this answer" class="short-link" id="link-post-327566">share</a><span class="lsep">|</span><a href="/posts/327566/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2008-11-29 14:06:46Z" class="relativetime">Nov 29 '08 at 14:06</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/27233/huaghaguah"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/aa4851917cf74f429d376432611ee6a5?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/27233/huaghaguah">HUAGHAGUAH</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">765</span><span title="3 silver badges"><span class="badge2"></span><span class="badgecount">3</span></span><span title="3 bronze badges"><span class="badge3"></span><span class="badgecount">3</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-327566" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-166570" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I use use SIMD (e.g. SSE) operations for simple transforms.  However, normal mapping and blur are a little more complicated and require more computations.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 18:14:35Z" class="relativetime-clean">Nov 29 '08 at 18:14</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-327566" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="12642535"></a>
<div id="answer-12642535" class="answer" data-answerid="12642535"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="12642535">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">1</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Check the <a href="http://msdn.microsoft.com/en-us/library/ff398050%28v=vs.100%29.aspx" rel="nofollow">Creating an Image-Processing Network</a> walkthrough on MSDN, which explains how to use Parallel Patterns Library to compose a concurrent image processing pipeline.</p>

<p>I'd also suggest <a href="http://www.boost.org/doc/libs/release/libs/gil" rel="nofollow">Boost.GIL</a>, which generates highly efficient code. For simple multi-threaded example, check <a href="https://github.com/bogado/gil_threaded" rel="nofollow">gil_threaded</a> by Victor Bogado. The <a href="http://dancinghacker.com/code/dataflow/dataflow/signals/introduction/examples/gil.html" rel="nofollow">An image processing network using Dataflow.Signals and Boost.GIL</a> explains an interestnig dataflow model too.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/12642535" title="short permalink to this answer" class="short-link" id="link-post-12642535">share</a><span class="lsep">|</span><a href="/posts/12642535/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2012-09-28 15:02:10Z" class="relativetime">Sep 28 '12 at 15:02</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/151641/mloskot"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/8dbfbbc4e48afe0caa43412a8c03ef07?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/151641/mloskot">mloskot</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 19098" dir="ltr">19.1k</span><span title="6 gold badges"><span class="badge1"></span><span class="badgecount">6</span></span><span title="58 silver badges"><span class="badge2"></span><span class="badgecount">58</span></span><span title="73 bronze badges"><span class="badge3"></span><span class="badgecount">73</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-12642535" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-12642535" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326500"></a>
<div id="answer-326500" class="answer" data-answerid="326500"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326500">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>One thread per pixel row is insane, best have around n-1 to 2n threads (for n cpu's), and make each one loop fetching one jobunit (may be one row, or other kind of partition)</p>

<p>on unix-like, use pthreads it's simple and lightweight.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326500" title="short permalink to this answer" class="short-link" id="link-post-326500">share</a><span class="lsep">|</span><a href="/posts/326500/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:33:48Z" class="relativetime">Nov 28 '08 at 19:33</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/11649/javier"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/5e4103707f37d83ebd26d960c70948c2?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/11649/javier">Javier</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 39873" dir="ltr">39.9k</span><span title="5 gold badges"><span class="badge1"></span><span class="badgecount">5</span></span><span title="53 silver badges"><span class="badge2"></span><span class="badgecount">53</span></span><span title="103 bronze badges"><span class="badge3"></span><span class="badgecount">103</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326500" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326500" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326523"></a>
<div id="answer-326523" class="answer" data-answerid="326523"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326523">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Maybe write your own tiny library which implements a few standard threading functions using <code>#ifdef</code>'s for every platform? There really isn't much to it, and that would reduce the executable size way more than any library you could use.</p>

<p><b>Update:</b> And for work distribution - split your image into pieces and give each thread a piece. So that when it's done with the piece, it's done. This way you avoid implementing job queues that will further increase your executable's size.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326523" title="short permalink to this answer" class="short-link" id="link-post-326523">share</a><span class="lsep">|</span><a href="/posts/326523/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/326523/revisions" title="show all edits to this post">edited <span title="2008-11-28 19:55:57Z" class="relativetime">Nov 28 '08 at 19:55</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-11-28 19:50:23Z" class="relativetime">Nov 28 '08 at 19:50</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/41360/vilx"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/41360/vilx">Vilx-</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 45895" dir="ltr">45.9k</span><span title="50 gold badges"><span class="badge1"></span><span class="badgecount">50</span></span><span title="181 silver badges"><span class="badge2"></span><span class="badgecount">181</span></span><span title="316 bronze badges"><span class="badge3"></span><span class="badgecount">316</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326523" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326523" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="327172"></a>
<div id="answer-327172" class="answer" data-answerid="327172"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="327172">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I think regardless of the threading model you choose (boost, pthread, native threads, etc). I think you should consider a thread pool as opposed to a thread per row. Threads in a thread pool are very cheap to "start" since they are already created as far as the OS is concerned, it's just a matter of giving it something to do.</p>

<p>Basically, you could have say 4 threads in your pool. Then in a serial fashion, for each pixel, tell the next thread in the thread pool to process the pixel. This way you are effectively processing no more than 4 pixels at a time. You could make the size of the pool based either on user preference or on the number of CPUs the system reports.</p>

<p>This is by far the simplest way IMHO to add threading to a SIMD task.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/327172" title="short permalink to this answer" class="short-link" id="link-post-327172">share</a><span class="lsep">|</span><a href="/posts/327172/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/327172/revisions" title="show all edits to this post">edited <span title="2008-11-29 05:48:36Z" class="relativetime">Nov 29 '08 at 5:48</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-11-29 04:39:39Z" class="relativetime">Nov 29 '08 at 4:39</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/13430/evan-teran"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/QUCnD.png?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/13430/evan-teran">Evan Teran</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 50587" dir="ltr">50.6k</span><span title="10 gold badges"><span class="badge1"></span><span class="badgecount">10</span></span><span title="130 silver badges"><span class="badge2"></span><span class="badgecount">130</span></span><span title="198 bronze badges"><span class="badge3"></span><span class="badgecount">198</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-327172" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-166141" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Sounds good.  I&#39;ll implement this along side an OpenMP implementation and compare.  Thanks for your clarification on how thread pools work.  =]</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 05:05:50Z" class="relativetime-clean">Nov 29 '08 at 5:05</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-166169" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Just a note, it&#39;s entirely possible (I honestly don&#39;t know) that OpenMP uses thread pools already to a reasonable degree. So OpenMP is likely going to work nicely for you as well.</span>
                    &ndash;&nbsp;<a href="/users/13430/evan-teran"
                       title="50587 reputation"
                       class="comment-user">Evan Teran</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-29 05:48:11Z" class="relativetime-clean">Nov 29 '08 at 5:48</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-327172" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="2072850"></a>
<div id="answer-2072850" class="answer" data-answerid="2072850"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2072850">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Your compiler doesn't support OpenMP. Another option is to use a library approach, both Intel's Threading Building Blocks and Microsoft Concurrency Runtime are available (VS 2010).</p>

<p>There is also a set of interfaces called the Parallel Pattern Library which are supported by both libraries and in these have a templated parallel_for library call.
so instead of:</p>

<pre><code>#pragma omp parallel for 
for (i=0; i &lt; numPixels; i++) 
{ ...} 
</code></pre>

<p>you would write:</p>

<pre><code>parallel_for(0,numPixels,1,ToGrayScale());
</code></pre>

<p>where ToGrayScale is a functor or pointer to function. (Note if your compiler supports lambda expressions which it likely doesn't you can inline the functor as a lambda expression).</p>

<pre><code>parallel_for(0,numPixels,1,[&amp;](int i)
{  
   pGrayScaleBitmap[i] = (unsigned BYTE)  
       (pRGBBitmap[i].red * 0.299 +  
        pRGBBitmap[i].green * 0.587 +  
        pRGBBitmap[i].blue * 0.114);  
});
</code></pre>

<p>-Rick</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/2072850" title="short permalink to this answer" class="short-link" id="link-post-2072850">share</a><span class="lsep">|</span><a href="/posts/2072850/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-15 15:55:26Z" class="relativetime">Jan 15 '10 at 15:55</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/67753/rick"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/57a52672427678f8a940e5a016292c5e?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/67753/rick">Rick</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">2,765</span><span title="8 silver badges"><span class="badge2"></span><span class="badgecount">8</span></span><span title="16 bronze badges"><span class="badge3"></span><span class="badgecount">16</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2072850" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2072850" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="2072896"></a>
<div id="answer-2072896" class="answer" data-answerid="2072896"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2072896">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I think map/reduce framework will be the ideal thing to use in this situation. You can use Hadoop streaming to use your existing C++ application.</p>

<p>Just implement the map and reduce jobs.</p>

<p>As you said, you can use row-level maniputations as a map task and combine the row level manipulations to the final image in the reduce task.</p>

<p>Hope this is useful.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/2072896" title="short permalink to this answer" class="short-link" id="link-post-2072896">share</a><span class="lsep">|</span><a href="/posts/2072896/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-15 16:00:12Z" class="relativetime">Jan 15 '10 at 16:00</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/207335/boolean"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/adba96e323095f3e286254841893b5b2?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/207335/boolean">Boolean</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">3,957</span><span title="16 gold badges"><span class="badge1"></span><span class="badgecount">16</span></span><span title="62 silver badges"><span class="badge2"></span><span class="badgecount">62</span></span><span title="109 bronze badges"><span class="badge3"></span><span class="badgecount">109</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2072896" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2072896" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="2070937"></a>
<div id="answer-2070937" class="answer" data-answerid="2070937"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2070937">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>It is very possible, that bottleneck is not CPU but memory bandwidth, so multi-threading WON'T help a lot. Try to minimize memory access and work on limited memory blocks, so that more data can be cached. I had a similar problem a while ago and I decided to optimize my code to use SSE instructions. Speed increase was almost 4x per single thread!</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/2070937" title="short permalink to this answer" class="short-link" id="link-post-2070937">share</a><span class="lsep">|</span><a href="/posts/2070937/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/2070937/revisions" title="show all edits to this post">edited <span title="2012-06-26 16:32:09Z" class="relativetime">Jun 26 '12 at 16:32</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/74022/brandon"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/YL96W.jpg?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/74022/brandon">Brandon</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 44337" dir="ltr">44.3k</span><span title="20 gold badges"><span class="badge1"></span><span class="badgecount">20</span></span><span title="121 silver badges"><span class="badge2"></span><span class="badgecount">121</span></span><span title="169 bronze badges"><span class="badge3"></span><span class="badgecount">169</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-15 10:54:30Z" class="relativetime">Jan 15 '10 at 10:54</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/293138/0xdead-beef"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/bcdcbed0226c2c15f34b4c4ed143c11f?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/293138/0xdead-beef">0xDEAD BEEF</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">809</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="19 silver badges"><span class="badge2"></span><span class="badgecount">19</span></span><span title="38 bronze badges"><span class="badge3"></span><span class="badgecount">38</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2070937" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2070937" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="27856850"></a>
<div id="answer-27856850" class="answer" data-answerid="27856850"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="27856850">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>You also could use libraries like <a href="https://software.intel.com/en-us/intel-ipp" rel="nofollow">IPP</a> or the <a href="http://www.cassandra-vision.com/" rel="nofollow">Cassandra Vision</a> C++ API that are mostly much more optimized than you own code.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/27856850" title="short permalink to this answer" class="short-link" id="link-post-27856850">share</a><span class="lsep">|</span><a href="/posts/27856850/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-01-09 08:55:29Z" class="relativetime">Jan 9 '15 at 8:55</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/2508887/steffen-roeber"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/8b883c2dba14fb74e11e18b0021a416c?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/2508887/steffen-roeber">Steffen Roeber</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">29</span><span title="4 bronze badges"><span class="badge3"></span><span class="badgecount">4</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-27856850" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-27856850" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="326752"></a>
<div id="answer-326752" class="answer downvoted-answer" data-answerid="326752"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="326752">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">-3</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>There's another option of using assembly for optimization. Now, one exciting project for dynamic code generation is <a href="https://gna.org/svn/?group=softwire" rel="nofollow">softwire</a> (which dates back awhile - <a href="http://softwire.sourceforge.net/" rel="nofollow">here</a> is the original project's site). It has been developed by Nick Capens and grew into now commercially available <a href="http://www.transgaming.com/products/swiftshader/" rel="nofollow">swiftshader</a>. But the spin-off of the original softwire is still available on gna.org.
<p><a href="http://www.flipcode.com/archives/Pure_Run-Time_Assembler.shtml" rel="nofollow">This</a> could serve as an introduction to his solution. 
<p>Personally, I don't believe you can gain significant performance by utilizing multiple threads for your problem.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/326752" title="short permalink to this answer" class="short-link" id="link-post-326752">share</a><span class="lsep">|</span><a href="/posts/326752/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2008-11-28 21:50:56Z" class="relativetime">Nov 28 '08 at 21:50</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/23713/deemok"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f98db0f15038b99fcf643e3bc93fbc14?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/23713/deemok">deemok</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">2,271</span><span title="10 silver badges"><span class="badge2"></span><span class="badgecount">10</span></span><span title="8 bronze badges"><span class="badge3"></span><span class="badgecount">8</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
            
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-326752" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-165801" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Seriously?  You don&#39;t think there is inherent parallelism in image processing?  Do you know what GPUs do?</span>
                    &ndash;&nbsp;<a href="/users/9122/tgamblin"
                       title="32635 reputation"
                       class="comment-user">tgamblin</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:04:44Z" class="relativetime-clean">Nov 28 '08 at 22:04</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165803" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Each image manipulation takes anywhere from 8 seconds to 6 minutes of my 1.7GHz 64-bit system, depending on the manipulation chosen and the parameters.  I would really like to bring that 6 minutes down.  Even 3 minutes (my system is dual core) is acceptable.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:04:56Z" class="relativetime-clean">Nov 28 '08 at 22:04</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165805" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I have to agree with @tgamblin&#39;s comment.  GPU&#39;s have literally hundreds of stream processors operating to render the final image.  These have many inputs (texture data, lighting parameters, and shader code, for example) and produce one output (a texel).  I am doing something similar.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:07:05Z" class="relativetime-clean">Nov 28 '08 at 22:07</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-165832" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Using assembly isn&#39;t really an option -- I need portable code.  Also, assembly is more difficult to maintain.  I&#39;m looking for a clean solution which doesn&#39;t require much code to be changed to implement the optimization.</span>
                    &ndash;&nbsp;<a href="/users/39992/strager"
                       title="52793 reputation"
                       class="comment-user owner">strager</a>
                <span class="comment-date" dir="ltr"><span title="2008-11-28 22:25:23Z" class="relativetime-clean">Nov 28 '08 at 22:25</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-326752" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>
									<a name='new-answer'></a>
						<form id="post-form" action="/questions/326487/answer/submit" method="post"  class="post-form">
						    <input type="hidden" id="post-id" value="326487" />
                            <input type="hidden" id="qualityBanWarningShown" name="qualityBanWarningShown" value="false" />
                            <input type="hidden" name="referrer" value=""/>
							<h2 class="space">Your Answer</h2>


            <script>
            StackExchange.ifUsing("editor", function () {
                StackExchange.using("externalEditor", function () {
                    StackExchange.using("snippets", function () {
                        StackExchange.snippets.init();
                    });
                });
            }, "code-snippets");
        </script>
    

<script>
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
       
        StackExchange.using("externalEditor", function() {
                // Have to fire editor after snippets, if snippets enabled
                if (StackExchange.options.snippets.enabled) {
                    StackExchange.using("snippets", function() {
                        createEditor();
                    });
                }
                else {
                    createEditor();
                }
            });

            function createEditor() {
                prepareEditor({
                    heartbeatType: 'answer',
                convertImagesToLinks: true,
                reputationToPostImages: 10,
                bindNavPrevention: true,
                postfix: "",
                    onDemand: true,
                    discardSelector: ".discard-answer"
                    ,immediatelyShowMarkdownHelp:true
                    });
                

        }
    });  
</script>


<div id="post-editor" class="post-editor js-post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="8872ec4c653acc968af5bcb434502271">
        <input id="author" name="author" type="text">
    </div>



</div>
							<div style="position: relative;">
								
								            <div class="form-item dno new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="/users/login?ssrc=question_page&returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%23new-answer">log in</a></h3>
                        <script>
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Email and Password</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid" />
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false" />
                    <input type="hidden" name="use-google" class="use-google" value="false" />
                    <input type="button" class="submit-openid" value="Submit" style="display:none" />
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="email" size="30" maxlength="100" value="" tabindex="106" placeholder="required, but never shown" />
                </div>
            </td>
        </tr>
        </table>
    </div>

                    </div>
                </div>
            </div>
            <script>
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', 'http%3a%2f%2fstackoverflow.com%2fquestions%2f326487%2fmultithreaded-image-processing-in-c%23new-answer', 'question_page');
                    }
                );
            </script>
            <noscript>
                        <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="email" size="30" maxlength="100" value="" tabindex="106" placeholder="required, but never shown" />
                </div>
            </td>
        </tr>
        </table>
    </div>

            </noscript>

							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />								</div>
						</form>



						<h2 class="bottom-notice" data-loc="1">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <a href="/questions/tagged/multithreading" class="post-tag" title="show questions tagged &#39;multithreading&#39;" rel="tag">multithreading</a> <a href="/questions/tagged/optimization" class="post-tag" title="show questions tagged &#39;optimization&#39;" rel="tag">optimization</a> <a href="/questions/tagged/image-processing" class="post-tag" title="show questions tagged &#39;image-processing&#39;" rel="tag">image-processing</a> <a href="/questions/tagged/parallel-processing" class="post-tag" title="show questions tagged &#39;parallel-processing&#39;" rel="tag">parallel-processing</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
						    <div class="module question-stats">
			        <table id="qinfo">
			            <tr>
			                <td>
			                    <p class="label-key">asked</p>
			                </td>
			                <td style="padding-left: 10px">
			                    <p class="label-key" title="2008-11-28 19:24:49Z"><b>7 years ago</b></p>
			                </td>
			            </tr>
			            <tr>
			                <td>
			                    <p class="label-key">viewed</p>
			                </td>

			                <td style="padding-left: 10px">
			                    <p class="label-key">
			                        <b>6412 times</b>
			                    </p>
			                </td>
			            </tr>
			                <tr>
			                    <td>
			                        <p class="label-key">active</p>
			                    </td>
			                    <td style="padding-left: 10px">
			                        <p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2015-01-09 08:55:29Z">1 year ago</a></b></p>
			                    </td>
			                </tr>
			        </table>
			    </div>
			<div class="module community-bulletin" data-tracker="cb=1">
    <div class="related">
                <div class="bulletin-title">
                    Upcoming Events
                </div>
                <hr />
    <div class="spacer">
        
    <div class="bulletin-item-type"><a href="http://meta.stackoverflow.com/questions/314186/stack-overflow-annual-survey-2016?so" class="question-hyperlink"><div class="favicon favicon-stackoverflow" title="Stack Overflow"></div></a></div>
    <div class="bulletin-item-content">
        <a href="http://meta.stackoverflow.com/questions/314186/stack-overflow-annual-survey-2016?so" class="question-hyperlink">Take the Stack Overflow Developer Survey</a>
        <div>ends <span title="2016-01-21 01:00:00Z" class="relativetime">in 9 days</span></div>
    </div>
    <br class="cbt" />
</div>
    </div>
</div>			
			<script>
                var ados = ados || {}; ados.run = ados.run || [];
                ados.run.push(function () { ados_add_placement(22,8277,"adzerk1427911828",[17,2221]).setZone(45); });
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk1427911828">
            </div>
        <div id="hireme">
            <script>
;var _extends=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n};(function(n){function f(){return(new Date).getTime()}function rt(n,t){return n.split(/\&/g).reduce(function(n,t){var i=t.split("=");return n[v(i[0])]=v(i[1]),n},t||{})}function ut(n,t){return Object.keys(n).filter(function(n){return t.indexOf(n)!==-1}).map(function(t){return u(t)+"="+u(n[t])}).join("&")}function y(n){return i.querySelectorAll(n)}function r(n){return i.querySelector(n)}function p(n,t,r){var u=i.createElement("script"),e="onreadystatechange",o="onload",f="readyState",s=!1;u.async=!0;u.src=n;typeof t=="function"&&(u[o]=u[e]=function(){s||u[f]&&u[f]!=="loaded"&&u[f]!=="complete"||(s=!0,typeof t=="function"&&t(u),u[o]=u[e]=null,r&&u.parentNode.removeChild(u))});nt.appendChild(u)}function w(n){var t=i.createElement("link");t.type="text/css";t.rel="stylesheet";t.href=n;tt.appendChild(t)}function ft(){return[].map.call(y(".post-taglist .post-tag"),function(n){return n.innerText}).join(";")||null}function et(){var n=t.StackExchange,i="options",r="user";return n&&n[i]&&n[i][r]&&n[i][r].accountId}function ot(n){var t,i;return n=rt(s.hash?s.hash.substr(1):"",n||{}),t=n.ac||n.accountId||et(),t&&(n.ac=t),n.tags||(i=ft(),i&&(n.tags=i)),n}function b(n){return n.innerHTML.replace(/\s+$/g,"")}function st(n,t,i,u){var c=r(n);if(c===null)return function(){};var h=null,s=null,l=f(),a=function a(){b(c)?(o(h),u(!1,f()-l)):s=e(a,t)};return s=e(a,t),i&&(h=e(function(){o(s);u(!0,f()-l)},i)),function(){o(s);o(h)}}function ht(){var t="careers1",i="careers3",u=!d()||r("#careersadsdoublehigh"),f=u?1:2,n=[f+"=hireme"];return r("#"+t)&&n.push("5="+t),r("#"+i)&&n.push("6="+i),n.join("&")}function k(n,i){var r=ot(_extends({},g,{zones:ht()})),u,e;n&&(r.azt=1);i&&(r.lw=i);typeof t.innerWidth=="number"&&(r.bw=t.innerWidth);u=["zones","ip","ac","eng","prov","tags","theme","at","remote","seed","lw","azt","sysadmin","bw","nocpm"];e=l+"?"+ut(r,u);c=f();p(e)}function ct(n){function h(){u.forEach(w);e.forEach(function(n){lt(n,i[n],s,o)});typeof t.clc_after_load=="function"&&t.clc_after_load()}var i=n.cr,r=n.h,u=n.st,e=Object.keys(i),o=c?f()-c:0,s="//"+r+"/ct";h()}function lt(n,t,i,f){var h=t.cl,c=t.cn,o=t.an,l=t.utm,s=(h||[]).join(" "),e=r("#"+n);e&&(s&&(e.className+=" "+s),e.innerHTML=c.replace("&pt=0","&pt="+(f||0)),e.onmousedown=function(n){for(var t=n.target,r,f,s;t.tagName!=="A"&&t!==e;)t=t.parentNode;t!==e&&(r=[],o&&r.push("an="+o),f=[].filter.call(t.attributes,function(n){return/^data-/.test(n.name)}),f.length>0&&f.forEach(function(n){var t=n.name.replace(/^data-/,"");r.push(u(t)+"="+u(n.value))}),r.push("utm="+u(it+l)),s="",r.length>0&&(s="?"+r.join("&")),t.href=i+s)})}function d(){return y(h).length>0}function at(n){var t=i.createElement("a");return t.href=n,t.host}function vt(){var t,n;d()?(n=st(h,20,t,function(n,t){k(n,t)}),e(function(){var u=r(h),t;b(u)||(u.parentNode.removeChild(u),typeof n=="function"&&n(),t=i.createElement("img"),t.src="//"+at(l)+"/to.gif",t.style.display="none",i.body.appendChild(t))},2e3)):k()}var l=n.u,a=n.o,g=a===undefined?{}:a,t=window,s=t.location,u=t.encodeURIComponent,v=t.decodeURIComponent,i=t.document,nt=i.body,tt=i.getElementsByTagName("head")[0],e=t.setTimeout,o=t.clearTimeout,it="&utm_source="+s.hostname+"&utm_medium=ad&utm_campaign=",h="#sidebar [id^=adzerk].everyonelovesstackoverflow",c=0;t.clc={init:ct,load:vt,ls:p,as:w}}).call(null, {"u":"//clc.stackoverflow.com/p.js"});var allowedHosts=["stackoverflow.com","serverfault.com"];(allowedHosts[0]==="*"||allowedHosts.indexOf(location.hostname)!==-1)&&window.clc.load();            </script>
        </div>
			<div style="margin-bottom: 10px;">
        

<style type="text/css">
#newsletter-ad {
    width: 190px;
    height: 250px;
    overflow: hidden;
    background: url('//cdn.sstatic.net/stackoverflow/img/newsletter-ad.png?v=2');
    padding: 0 15px 0 15px;
}
#newsletter-ad-header {
    margin-top: 60px;
}
#newsletter-ad ul {
    margin: 1em 0 1em 1.5em;
}
#newsletter-ad ul li {
    margin-bottom: 5px;
}
#newsletter-signup-container {
    text-align: center;
}
#newsletter-preview-container {
    margin-top: 10px;
    text-align: center;
}
#newsletter-email-input {
    width: 200px;
}
</style>

<script>
    StackExchange.ready(function () {
        StackExchange.newsletterAd.init();
    });
</script>

<div id="newsletter-ad">
    <p id="newsletter-ad-header">Get the <b>weekly newsletter!</b></p>
    <ul>
        <li>Top questions and answers</li>
        <li>Important announcements</li>
        <li>Unanswered questions</li>
    </ul>
    <div id="newsletter-signup-container"><input id="newsletter-signup" type="button" value="Sign up for the newsletter" /></div>
    <p id="newsletter-preview-container">see an <a href="//stackexchange.com/newsletters/newsletter?site=stackoverflow.com" id="newsletter-preview">example newsletter</a></p>
    <div class="dno">
        
<p class="privacy-policy-agreement">
By subscribing, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />
    </div>
</div>

    </div>  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="/q/615264" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">37</div>
	</a>
	<a href="/questions/615264/c-parallelization-libraries-openmp-vs-thread-building-blocks" class="question-hyperlink">C++ Parallelization Libraries: OpenMP vs. Thread Building Blocks</a>
</div><div class="spacer">
	<a href="/q/333043" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">6</div>
	</a>
	<a href="/questions/333043/use-of-threads-in-c" class="question-hyperlink">Use of threads in C++</a>
</div>			</div>
</div>

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
                    <div class="related js-gps-related-questions" data-tracker="rq=1">
                        <div class="spacer">
<a href="/q/6388031" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">10
    </div>
</a><a href="/questions/6388031/multithreading-vs-multiprocessing" class="question-hyperlink">Multithreading vs multiprocessing</a>
</div>
<div class="spacer">
<a href="/q/6430448" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted extra-large">1445
    </div>
</a><a href="/questions/6430448/why-doesnt-gcc-optimize-aaaaaa-to-aaaaaa" class="question-hyperlink">Why doesn&#39;t GCC optimize a*a*a*a*a*a to (a*a*a)*(a*a*a)?</a>
</div>
<div class="spacer">
<a href="/q/10168686" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">880
    </div>
</a><a href="/questions/10168686/algorithm-improvement-for-coca-cola-can-shape-recognition" class="question-hyperlink">Algorithm improvement for Coca-Cola can shape recognition</a>
</div>
<div class="spacer">
<a href="/q/11227809" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted extra-large">13268
    </div>
</a><a href="/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array" class="question-hyperlink">Why is processing a sorted array faster than an unsorted array?</a>
</div>
<div class="spacer">
<a href="/q/13554112" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/13554112/c-sharp-multithreaded-processing-of-a-single-image-webcam-frames" class="question-hyperlink">C# - Multithreaded Processing of a single Image (Webcam Frames)</a>
</div>
<div class="spacer">
<a href="/q/18211907" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/18211907/multithread-in-a-java-image-processing-program" class="question-hyperlink">Multithread in a java image processing program</a>
</div>
<div class="spacer">
<a href="/q/20576047" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/20576047/fast-multithreaded-image-processing-not-so-fast" class="question-hyperlink">Fast multithreaded image processing, not so fast</a>
</div>
<div class="spacer">
<a href="/q/28056889" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/28056889/parallelism-vs-threading-performance" class="question-hyperlink">Parallelism vs Threading - Performance</a>
</div>
<div class="spacer">
<a href="/q/29319226" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/29319226/parallel-image-processing-in-openmp-splitting-image" class="question-hyperlink">Parallel Image Processing in OpenMP - Splitting Image</a>
</div>
<div class="spacer">
<a href="/q/30529701" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/30529701/multithreaded-image-processing-slower-than-single-thread" class="question-hyperlink">Multithreaded Image Processing slower than Single Thread?</a>
</div>

                    </div>
				</div>
            
<div id="hot-network-questions" class="module">
    <h4>
        <a href="//stackexchange.com/questions?tab=hot" 
           class="js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li >
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/299167/should-ya-have-an-apostrophe-doin-etc" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Should &quot;ya&quot; have an apostrophe? &quot;Doin&quot;? Etc
                </a>

            </li>
            <li >
                <div class="favicon favicon-codereview" title="Code Review Stack Exchange"></div><a href="http://codereview.stackexchange.com/questions/116469/print-the-n-longest-lines-in-a-file" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:196 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Print the N longest lines in a file
                </a>

            </li>
            <li >
                <div class="favicon favicon-softwarerecs" title="Software Recommendations Stack Exchange"></div><a href="http://softwarerecs.stackexchange.com/questions/27960/is-there-an-ultra-lightweight-editor-like-pythons-idle-for-c" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:536 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is there an ultra-lightweight editor (like Python&#39;s IDLE) for C?
                </a>

            </li>
            <li >
                <div class="favicon favicon-scifi" title="Science Fiction &amp; Fantasy Stack Exchange"></div><a href="http://scifi.stackexchange.com/questions/114517/how-does-working-on-a-moisture-farm-work" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:186 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How does working on a moisture farm work?
                </a>

            </li>
            <li >
                <div class="favicon favicon-money" title="Personal Finance &amp; Money Stack Exchange"></div><a href="http://money.stackexchange.com/questions/57931/are-lottery-tickets-ever-a-wise-investment-provided-the-jackpot-is-large-enough" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:93 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Are lottery tickets ever a wise investment provided the jackpot is large enough?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-stackoverflow" title="Stack Overflow"></div><a href="http://stackoverflow.com/questions/34732641/calling-list-has-side-effect" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:1 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Calling list() has side-effect?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-electronics" title="Electrical Engineering Stack Exchange"></div><a href="http://electronics.stackexchange.com/questions/210799/short-range-low-bitrate-data-transmission-under-water" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:135 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Short range - low bitrate data transmission under water
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-photo" title="Photography Stack Exchange"></div><a href="http://photo.stackexchange.com/questions/72677/could-a-universal-exposure-setting-be-practically-possible" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:61 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Could a &quot;universal exposure&quot; setting be practically possible?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-worldbuilding" title="Worldbuilding Stack Exchange"></div><a href="http://worldbuilding.stackexchange.com/questions/33066/why-are-monasteries-so-remote" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:579 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why are monasteries so remote?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-earthscience" title="Earth Science Stack Exchange"></div><a href="http://earthscience.stackexchange.com/questions/7212/why-is-the-pond-in-my-backyard-not-frozen-when-it-is-5-degrees-f" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:553 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why is the pond in my backyard not frozen when it is 5 degrees F?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-mathematica" title="Mathematica Stack Exchange"></div><a href="http://mathematica.stackexchange.com/questions/103834/how-to-repeat-a-matrix-on-its-side" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:387 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to repeat a matrix on it&#39;s side?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-gaming" title="Arqade"></div><a href="http://gaming.stackexchange.com/questions/251478/how-important-is-it-to-upgrade-ship-weapons-in-mass-effect-2" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:41 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How important is it to upgrade ship weapons in Mass Effect 2?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-salesforce" title="Salesforce Stack Exchange"></div><a href="http://salesforce.stackexchange.com/questions/104924/radio-options-appearing-all-in-one-line" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:459 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Radio options appearing all in one line
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-puzzling" title="Puzzling Stack Exchange"></div><a href="http://puzzling.stackexchange.com/questions/25165/three-logicians-walk-out-of-the-bar" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:559 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Three logicians walk out of the bar
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-superuser" title="Super User"></div><a href="http://superuser.com/questions/1024672/is-it-possible-to-create-firewall-that-only-allows-legitimate-webserver-traffic" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:3 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is it possible to create firewall that only allows legitimate webserver traffic on port 443 and not any other service?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-unix" title="Unix &amp; Linux Stack Exchange"></div><a href="http://unix.stackexchange.com/questions/254599/how-to-get-the-computer-name-not-its-hostname" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:106 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to get the computer name (not its hostname)?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-ux" title="User Experience Stack Exchange"></div><a href="http://ux.stackexchange.com/questions/88938/one-big-sign-up-button-or-3" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:102 }); posts_hot_network.click({ item_type:2, location:11 })">
                    One big sign up button or 3
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/299164/is-english-the-only-language-that-always-capitalizes-i" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is English the only language that always capitalizes &quot;I&quot;?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/1608035/whats-between-the-finite-and-the-infinite" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What&#39;s between the finite and the infinite?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-aviation" title="Aviation Stack Exchange"></div><a href="http://aviation.stackexchange.com/questions/24254/after-a-crash-for-how-long-is-the-airport-closed" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:528 }); posts_hot_network.click({ item_type:2, location:11 })">
                    After a crash, for how long is the airport closed?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-scifi" title="Science Fiction &amp; Fantasy Stack Exchange"></div><a href="http://scifi.stackexchange.com/questions/114475/what-was-c-3po-talking-about-when-he-said-that-s-funny-the-damage-doesn-t-loo" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:186 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What was C-3PO talking about when he said, “That’s funny, the damage doesn’t look as bad from out here.”
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-codegolf" title="Programming Puzzles &amp; Code Golf Stack Exchange"></div><a href="http://codegolf.stackexchange.com/questions/69203/quinean-regex-tester" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:200 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Quinean Regex Tester
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-unix" title="Unix &amp; Linux Stack Exchange"></div><a href="http://unix.stackexchange.com/questions/254693/intersperse-lines-from-two-files" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:106 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Intersperse lines from two files
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-gis" title="Geographic Information Systems Stack Exchange"></div><a href="http://gis.stackexchange.com/questions/176450/how-many-layers-are-too-many-layers-in-arcmap" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:79 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How many layers are too many layers in ArcMap?
                </a>

            </li>
    </ul>

        <a href="#" 
           class="show-more js-show-more js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:3, location:11 })">
            more hot questions
        </a>
</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text">
        <a href="/feeds/question/326487" title="feed of this question and its answers">
            <span class="feed-icon"></span>question feed
        </a>
    </div>
</div>	<script>
StackExchange.ready(function(){$.get('/posts/326487/ivc/4da6');});
</script>
<noscript>
    <div><img src="/posts/326487/ivc/4da6" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">lang-cpp</div></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/tour">tour</a>
                    <a href="/help">help</a>
                    <a href="http://blog.stackoverflow.com?blb=1">blog</a>
                        <a href="http://chat.stackoverflow.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/work-here">work here</a>
                    <a href="http://stackexchange.com/mediakit">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.stackoverflow.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="//stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="//serverfault.com" title="system and network administrators">Server Fault</a></li>
                        <li><a href="//superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="//webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="//askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="//webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="//gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="//tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="//programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="//unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems">Unix &amp; Linux</a></li>
                        <li><a href="//apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="//wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Development</a></li>
                        <li><a href="//gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="//electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="//android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="//security.stackexchange.com" title="information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="//dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="//drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="//sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="//ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="//mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                        <li><a href="//salesforce.stackexchange.com" title="Salesforce administrators, implementation experts, developers and anybody in-between">Salesforce</a></li>
                        <li><a href="//expressionengine.stackexchange.com" title="administrators, end users, developers and designers for ExpressionEngine&#174; CMS">ExpressionEngine&#174; Answers</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="//scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="//graphicdesign.stackexchange.com" title="Graphic Design professionals, students, and enthusiasts">Graphic Design</a></li>
                        <li><a href="//movies.stackexchange.com" title="movie and tv enthusiasts">Movies &amp; TV</a></li>
                        <li><a href="//cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="//diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                        <li><a href="//money.stackexchange.com" title="people who want to be financially literate">Personal Finance &amp; Money</a></li>
                        <li><a href="//academia.stackexchange.com" title="academics and those enrolled in higher education">Academia</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (9)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="//skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="//judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="//travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="//christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="//gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="//bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="//rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="//stats.stackexchange.com" title="people interested in statistics, machine learning, data analysis, data mining, and data visualization">Cross Validated (stats)</a></li>
                        <li><a href="//cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="//physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="//mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                        <li><a href="//chemistry.stackexchange.com" title="scientists, academics, teachers and students">Chemistry</a></li>
                        <li><a href="//biology.stackexchange.com" title="biology researchers, academics, and students">Biology</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (5)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="//meta.stackexchange.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Exchange</a></li>
                        <li><a href="//area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="//careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2016 Stack Exchange Inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a> 
                with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="svnrev">
                rev 2016.1.11.3159
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Stack Overflow works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>
<script>var p = "http", d = "static"; if (document.location.protocol == "https:") { p += "s"; d = "engine"; } var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = p + "://" + d + ".adzerk.net/ados.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script>
<script>
    var ados = ados || {};
    ados.run = ados.run || [];
    ados.run.push(function () {
        ados_setKeywords('c%2b%2b,multithreading,optimization,image-processing,parallel-processing');; ados_load();
    });         
</script>

    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-5620270-1');
                        ga('set', 'dimension2', '|c++|multithreading|optimization|image-processing|parallel-processing|');         ga('send', 'pageview');
        var _qevents = _qevents || [],
            _comscore = _comscore || [];
        (function () {
            var ssl='https:'==document.location.protocol,
                s=document.getElementsByTagName('script')[0],
                qc=document.createElement('script');
            qc.async=true;
            qc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
            s.parentNode.insertBefore(qc, s);
            var sc=document.createElement('script');
            sc.async=true;
            sc.src=(ssl?'https://sb':'http://b') + '.scorecardresearch.com/beacon.js';
            s.parentNode.insertBefore(sc, s);
        })();
        _comscore.push({ c1: "2", c2: "17440561" });
        _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>
            
    </body>
</html>